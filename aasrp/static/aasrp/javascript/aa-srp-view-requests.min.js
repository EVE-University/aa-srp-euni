$(document).ready(function(){"use strict";var srpRequestsTable=$("#tab_aasrp_srp_requests").DataTable({ajax:{url:aaSrpSettings.url.requestsForSrpLink,dataSrc:"",cache:false},columns:[{data:"request_time",render:$.fn.dataTable.render.moment(moment.ISO_8601,aaSrpSettings.datetimeFormat),className:"srp-request-time"},{data:"requester",className:"srp-request-requester"},{data:"character",className:"srp-request-character"},{data:"request_code",className:"srp-request-code"},{data:"ship_html",render:{display:"display",_:"sort"},className:"srp-request-ship"},{data:"zbk_loss_amount",render:function(data,type,row,meta){if(type==="display"){return data.toLocaleString()+" ISK"}else{return data}},className:"srp-request-zbk-loss-amount text-right"},{data:"payout_amount",render:function(data,type,row,meta){if(type==="display"){return'<span class="srp-payout-amount">'+data.toLocaleString()+" ISK</span>"}else{return data}},className:"srp-request-payout text-right"},{data:"request_status_icon",className:"srp-request-status text-center"},{data:"actions",className:"srp-request-actions"},{data:"ship"},{data:"request_status"}],columnDefs:[{orderable:false,targets:[7,8]},{visible:false,targets:[9,10]},{width:115,targets:[8]}],order:[[0,"asc"]],filterDropDown:{columns:[{idx:1},{idx:2},{idx:9,title:aaSrpSettings.translation.filterRequestShip},{idx:10,title:aaSrpSettings.translation.filterRequestStatus}],autoSize:false,bootstrap:true},paging:false,createdRow:function(row,data,rowIndex){$(row).attr("data-row-id",rowIndex);$(row).attr("data-srp-request-code",data.request_code);$(row).find("span.srp-payout-amount").addClass("srp-request-"+data.request_code);$(row).find("span.srp-payout-amount").attr("data-params","{csrfmiddlewaretoken:'"+aaSrpSettings.csrfToken+"'}");$(row).find("span.srp-payout-amount").attr("data-pk",data.request_code);$(row).find("span.srp-payout-amount").attr("data-value",data.payout_amount);$(row).find("span.srp-payout-amount").attr("data-url",aaSrpSettings.url.changeSrpAmount.replace("SRP_REQUEST_CODE",data.request_code))}});$("#tab_aasrp_srp_requests").editable({container:"body",selector:".srp-payout-amount",title:aaSrpSettings.translation.changeSrpPayoutHeader,type:"number",placement:"top",display:function(value,response){return false},success:function(response,newValue){newValue=parseInt(newValue);$(this).attr("data-value",newValue);var newValuewFormatted=newValue.toLocaleString()+" ISK";$(this).addClass("srp-payout-amount-changed");$(this).html(newValuewFormatted);var totalSrpAmount=0;$("#tab_aasrp_srp_requests .srp-payout-amount").each(function(){totalSrpAmount+=parseInt($(this).attr("data-value"))});$(".srp-fleet-total-amount").html(totalSrpAmount.toLocaleString()+" ISK")},validate:function(value){if(value===null||value===""){return aaSrpSettings.translation.editableValidate}}})});